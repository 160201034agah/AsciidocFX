/* Generated by Opal 0.8.0 */
Opal.modules["chart-block-macro/extension"] = function (Opal) {
    Opal.dynamic_require_severity = "ignore";
    var __self = Opal.top, $scope = Opal, nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass;

    if ($scope.get('RUBY_ENGINE')['$==']("opal")) {
    }
    ;
    __self.$include(Opal.get('Asciidoctor'));
    (function ($base, $super) {
        function $ChartBlockMacro() {
        };
        var __self = $ChartBlockMacro = $klass($base, $super, 'ChartBlockMacro', $ChartBlockMacro);

        var def = __self.$$proto, $scope = __self.$$scope;

        __self.$use_dsl();
        __self.$named("chart");

        return (def.$process = function (parent, target, attrs) {

                var $a, __self = this;

                var csvFile = (attrs['$[]']("data-uri")),
                    chartType = target,
                    title = (attrs['$[]']("title")),
                    alt = (attrs['$[]']("alt")),
                    caption = (attrs['$[]']("caption")),
                    width = (attrs['$[]']("width")),
                    height = (attrs['$[]']("height")),
                    scale = (attrs['$[]']("scale")),
                    align = (attrs['$[]']("align")),
                    type = (attrs['$[]']("type")),
                    role = (attrs['$[]']("role")),
                    link = (attrs['$[]']("link")),
                    float = (attrs['$[]']("float")),
                    filename = (attrs['$[]']("file")),
                    cache = (attrs['$[]']("cache")),
                    opt = (attrs['$[]']("opt")),
                    imagesdir = parent.$document().$attr('imagesdir', '');

                if (filename == "") {
                    return nil;
                }

                if (cache != "enabled") {
                    var parameters = [csvFile, imagesdir, parent.$image_uri(filename), chartType, opt].map(function (e) {
                        return e + "";
                    });

                    postMessage(JSON.stringify({
                        type: "afx",
                        func: "chartBuildFromCsv",
                        parameters: parameters
                    }));
                }

                var attributes = {
                    "target": filename,
                    "title": title,
                    "alt": alt,
                    "caption": caption,
                    "width": width,
                    "height": height,
                    "scale": scale,
                    "align": align,
                    "role": role,
                    "link": link,
                    "float": float,
                    "opt": opt
                };

                var keys = Object.keys(attributes);

                keys.forEach(function (key) {
                    if (attributes[key]["$nil?"]()) {
                        delete attributes[key];
                    }
                });

                return __self.$create_image_block(parent, Opal.hash(attributes))
                    ;
            }, nil) && 'process';
    })(__self, (($scope.get('Extensions')).$$scope.get('BlockMacroProcessor')));
    return (function ($base, $super) {
        function $ChartBlockProcessor() {
        };
        var __self = $ChartBlockProcessor = $klass($base, $super, 'ChartBlockProcessor', $ChartBlockProcessor);

        var def = __self.$$proto, $scope = __self.$$scope;

        __self.$use_dsl();
        __self.$named("chart");
        __self.$on_context(["open", "literal", "listing"]);
        __self.$parse_content_as("literal");

        return (def.$process = function (parent, reader, attrs) {

                var $a, __self = this;

                var chartType = (attrs['$[]'](2)),
                    title = (attrs['$[]']("title")),
                    alt = (attrs['$[]']("alt")),
                    caption = (attrs['$[]']("caption")),
                    width = (attrs['$[]']("width")),
                    height = (attrs['$[]']("height")),
                    scale = (attrs['$[]']("scale")),
                    align = (attrs['$[]']("align")),
                    type = (attrs['$[]']("type")),
                    role = (attrs['$[]']("role")),
                    link = (attrs['$[]']("link")),
                    float = (attrs['$[]']("float")),
                    filename = (attrs['$[]']("file")),
                    cache = (attrs['$[]']("cache")),
                    opt = (attrs['$[]']("opt")),
                    imagesdir = parent.$document().$attr('imagesdir', '');

                if (filename == "") {
                    return nil;
                }

                if (cache != "enabled") {

                    var parameters = [reader.$read(), imagesdir, parent.$image_uri(filename), chartType, opt].map(function (e) {
                        return e + "";
                    });

                    postMessage(JSON.stringify({
                        type: "afx",
                        func: "chartBuild",
                        parameters: parameters
                    }));
                    //afx.chartBuild();
                }

                var attributes = {
                    "target": filename,
                    "title": title,
                    "alt": alt,
                    "caption": caption,
                    "width": width,
                    "height": height,
                    "scale": scale,
                    "align": align,
                    "role": role,
                    "link": link,
                    "float": float,
                    "opt": opt
                };

                var keys = Object.keys(attributes);

                keys.forEach(function (key) {
                    if (attributes[key]["$nil?"]()) {
                        delete attributes[key];
                    }
                });

                return __self.$create_image_block(parent, Opal.hash(attributes))
                    ;
            }, nil) && 'process';
    })(__self, (($scope.get('Extensions')).$$scope.get('BlockProcessor')));
};
/* Generated by Opal 0.8.0 */
Opal.modules["chart-block-macro"] = function (Opal) {
    Opal.dynamic_require_severity = "ignore";
    var $a, $b, TMP_1, self = Opal.top, $scope = Opal, nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;

    if ($scope.get('RUBY_ENGINE')['$==']("opal")) {
        self.$require("chart-block-macro/extension")
    }
    ;
    return ($a = ($b = $scope.get('Extensions')).$register, $a.$$p = (TMP_1 = function () {
        var self = TMP_1.$$s || this;

        self.$block_macro($scope.get('ChartBlockMacro'));
        return self.$block($scope.get('ChartBlockProcessor'));
    }, TMP_1.$$s = self, TMP_1), $a).call($b);
};

Opal.require('chart-block-macro');
Opal.require('chart-block-macro/extension');